#!/bin/bash
[[ "$#" -lt 2 ]] \
	&& echo "Usage: $0 [service name] [team ip]" \
	&& exit 1

if [ "$3" = "-d" ];then
	set -x
fi
service="$1"
team="$2"

# for ip and port set 'SYSTEM_ID_FLAGS_IP' and 'SYSTEM_ID_FLAGS_PORT' in DestructiveFarm's config.py
# they will be set automatically by (our) start_sploit.py
# set them manually (or use default values) for use not with (our) DestructiveFarm
ip="${IDFIP:-10.10.0.1}"
port="${IDFPORT:-8081}"

# json will be printed to stdout, use jq or whatever to process it
curl http://$ip:$port/flagIds\?service\=$service\&team\=$team

if [ "$3" = "-d" ];then
	set +x
fi
